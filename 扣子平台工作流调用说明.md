# 扣子（coze）平台工作流调用流程说明文档


## 一、核心调用凭证
调用所有工作流需使用固定个人访问令牌（token），具体值为：  
`pat_bfFS5ooxdOoj9xpCK8VS9sSOlWWdkHdzs18TAv6u0pixs3aP3vTX4w6AWx6F5wKa`  


## 二、可用工作流清单
以下为三个可调用的工作流及其基础信息：

| 工作流名称                | 功能描述                                  | workflow_id（唯一标识）       |
|---------------------------|-------------------------------------------|-------------------------------|
| Event_Name_Identification | 优化用户输入的事件名称（校验并规范格式）  | 7534025846535258151           |
| Event_Collection          | 根据事件名称搜集相关新闻信息              | 7529567713032601643           |
| Event_Analysis            | 基于新闻列表梳理事件要素及完整时间线      | 7527334340147150857           |  


## 三、工作流调用详情（入参、方式、返回结果）
### 1. Event_Name_Identification（事件名称优化）
#### （1）入参要求
- 参数名：`input`  
- 类型：String  
- 说明：用户原始输入的事件相关文本  
- 示例：`"乱局！刚登基的雍正，有多难？雍正王朝的秘密！"`  

#### （2）调用方式（Curl Request）
```bash
curl -X POST 'https://api.coze.cn/v1/workflow/stream_run' \
-H "Authorization: Bearer pat_bfFS5ooxdOoj9xpCK8VS9sSOlWWdkHdzs18TAv6u0pixs3aP3vTX4w6AWx6F5wKa" \
-H "Content-Type: application/json" \
-d '{
  "workflow_id": "7534025846535258151",
  "parameters": {
    "input": "乱局！刚登基的雍正，有多难？雍正王朝的秘密！第27回"  # 替换为实际输入内容
  }
}'
```

#### （3）返回结果说明
- 核心返回字段：`content`（JSON格式字符串）  
  - 若输入合格：返回`{"event_name":"原输入字符串"}`  
  - 若输入需优化：返回`{"event_name":"优化后的事件名称"}`（如示例返回`{"event_name":"雍正登基初期困境事件"}`）  
  - 若输入无关事件：固定返回`{"event_name":"您输入的内容与事件无关，请输入事件名称。"}`  
- 其他字段：包含调用元数据（如`node_type`、`usage`等，可忽略）  


### 2. Event_Collection（事件新闻搜集）
#### （1）入参要求
- 参数名：`keyword`  
- 类型：String  
- 说明：经Event_Name_Identification优化后的事件名称  
- 示例：`"雍正登基初期困境事件"`  

#### （2）调用方式（Curl Request）
```bash
curl -X POST 'https://api.coze.cn/v1/workflow/stream_run' \
-H "Authorization: Bearer pat_bfFS5ooxdOoj9xpCK8VS9sSOlWWdkHdzs18TAv6u0pixs3aP3vTX4w6AWx6F5wKa" \
-H "Content-Type: application/json" \
-d '{
  "workflow_id": "7529567713032601643",
  "parameters": {
    "keyword": "雍正登基初期困境事件"  # 替换为优化后的事件名称
  }
}'
```

#### （3）返回结果说明
- 核心返回字段：`content`（JSON格式字符串），包含：  
  - `event_name`：输入的事件名称（同入参`keyword`）  
  - `news_list`：新闻列表（字符串数组，每个元素为一条相关新闻文本）  
- 示例：  
```json
{
  "event_name":"雍正登基初期困境事件",
  "news_list": [
    "康熙六十一年十一月十三日，康熙病逝于畅春园...",  # 新闻文本1
    "雍正继位之初面临诸多难题...",  # 新闻文本2
    "清朝康熙十五年，皇四子胤禛出生后被送养..."  # 新闻文本3
  ]
}
```


### 3. Event_Analysis（事件信息分析）
#### （1）入参要求
- 需传入两个参数：  
  - `event_name`：String类型，事件名称（同Event_Collection返回的`event_name`）  
  - `news_list`：数组类型，新闻列表（同Event_Collection返回的`news_list`）  
- 示例：  
```json
{
  "event_name": "雍正登基初期困境事件",
  "news_list": [
    "康熙六十一年十一月十三日，康熙病逝于畅春园...",
    "雍正继位之初面临诸多难题...",
    "清朝康熙十五年，皇四子胤禛出生后被送养..."
  ]
}
```

#### （2）调用方式（Curl Request）
```bash
curl -X POST 'https://api.coze.cn/v1/workflow/stream_run' \
-H "Authorization: Bearer pat_bfFS5ooxdOoj9xpCK8VS9sSOlWWdkHdzs18TAv6u0pixs3aP3vTX4w6AWx6F5wKa" \
-H "Content-Type: application/json" \
-d '{
  "workflow_id": "7527334340147150857",
  "parameters": {
    "event_name": "雍正登基初期困境事件",  # 替换为实际事件名称
    "news_list": [  # 替换为实际新闻列表
      "康熙六十一年十一月十三日，康熙病逝于畅春园...",
      "雍正继位之初面临诸多难题...",
      "清朝康熙十五年，皇四子胤禛出生后被送养..."
    ]
  }
}'
```

#### （3）返回结果说明
- 核心返回字段：`content`（JSON格式字符串），包含事件分析的9个核心变量（与“来龙去脉”软件需求中的变量定义一致）：  
  - `event_name`：事件名称  
  - `key_men`：核心人物  
  - `event_overview`：事件总览  
  - `key_point`：关键讨论点  
  - `latest`：最新进展  
  - `event_cause`：事件起因  
  - `event_process`：事件经过  
  - `event_result`：事件结果  
  - `timeline`：时间线数组（每个元素含`time`、`event_phase`等5个字段）  
- 示例：（同文档中返回结果，此处省略具体内容）  


## 四、通用调用说明
1. 所有工作流均通过`POST`请求调用，接口地址固定为：`https://api.coze.cn/v1/workflow/stream_run`  
2. 请求头必须包含：  
   - `Authorization: Bearer [token]`（token值见本文档第一部分）  
   - `Content-Type: application/json`  
3. 请求体（`d`参数）需严格包含`workflow_id`（对应工作流唯一标识）和`parameters`（对应工作流入参）  
4. 返回结果中，核心业务数据在`Message.content`字段中，为JSON格式字符串，需解析后使用